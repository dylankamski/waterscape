---
---

<div class="tab-panel" id="tab-detect">
  <div class="detect-grid">

    <div class="panel">
      <div class="panel-hd">
        <span class="panel-title">Text Analyzer</span>
        <span class="panel-badge">hasHiddenMessage · visibleText</span>
      </div>
      <div class="panel-body">
        <div class="field">
          <label class="field-label">Paste Any Text</label>
          <textarea id="detect-input" rows="6" placeholder="Paste text here to analyze for steganographic content…"></textarea>
        </div>
        <button class="action-btn primary" id="detect-btn" disabled>
          <span>Analyze with WASM</span>
          <span class="btn-sym">∃</span>
        </button>

        <div id="detect-result" style="display:none">
          <div class="detect-status" id="detect-status">
            <span class="detect-icon" id="detect-icon">∅</span>
            <div class="detect-status-info">
              <div class="detect-headline" id="detect-headline"></div>
              <div class="detect-detail" id="detect-detail"></div>
            </div>
          </div>

          <div class="detect-comparison">
            <div class="compare-col">
              <div class="compare-label">Original (chars count includes hidden)</div>
              <div class="compare-text" id="detect-original"></div>
              <div class="compare-stat" id="detect-total-len"></div>
            </div>
            <div class="compare-col">
              <div class="compare-label">Visible text only</div>
              <div class="compare-text" id="detect-visible"></div>
              <div class="compare-stat" id="detect-visible-len"></div>
            </div>
          </div>

          <div class="char-breakdown">
            <div class="breakdown-label">Character Breakdown</div>
            <div id="breakdown-bars"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="panel examples-panel">
      <div class="panel-hd">
        <span class="panel-title">Quick Examples</span>
      </div>
      <div class="panel-body">
        <p class="examples-hint">Click to load into the analyzer.</p>
        <button class="example-btn" id="ex-clean">
          <span class="ex-label">Clean Text</span>
          <span class="ex-desc">Normal text with no hidden payload.</span>
        </button>
        <button class="example-btn" id="ex-encoded">
          <span class="ex-label">Last P2P Encoded</span>
          <span class="ex-desc">Text from the P2P tab — contains live WASM-encrypted hidden data.</span>
        </button>
        <div class="examples-note" id="examples-note">
          Encode something in the P2P tab first to use this example.
        </div>
      </div>
    </div>

  </div>
</div>

<style>
  .detect-grid {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: var(--spacing-xl);
    align-items: start;
  }

  .panel {
    border: 1px solid var(--color-border);
    background: var(--color-bg);
  }

  .panel-hd {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-lg);
    border-bottom: 1px solid var(--color-border);
    background: var(--color-bg-secondary);
  }

  .panel-title {
    font-size: 0.6875rem;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .panel-badge { font-size: 0.625rem; color: var(--color-text-tertiary); }

  .panel-body { padding: var(--spacing-lg); }

  .field { margin-bottom: var(--spacing-md); }

  .field-label {
    display: block;
    font-size: 0.6875rem;
    color: var(--color-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: var(--spacing-xs);
  }

  .action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    width: 100%;
    padding: var(--spacing-md);
    font-size: 0.8125rem;
    font-family: var(--font-mono);
  }

  .action-btn.primary {
    background: var(--color-text);
    color: var(--color-bg);
    border-color: var(--color-text);
  }

  .action-btn.primary:hover {
    background: transparent;
    color: var(--color-text);
  }

  .action-btn:disabled { opacity: 0.35; cursor: not-allowed; }

  .btn-sym { opacity: 0.6; }

  .detect-status {
    display: flex;
    align-items: center;
    gap: var(--spacing-lg);
    padding: var(--spacing-lg);
    border: 1px solid var(--color-border);
    margin: var(--spacing-lg) 0;
    transition: border-color var(--transition-fast);
  }

  :global(.detect-status.detected) { border-color: var(--color-border-light); }
  :global(.detect-status.clean)    { border-color: var(--color-border); }

  .detect-icon { font-size: 1.75rem; opacity: 0.45; flex-shrink: 0; }

  .detect-headline { font-size: 0.875rem; font-weight: 500; margin-bottom: 4px; }

  .detect-detail { font-size: 0.75rem; color: var(--color-text-secondary); }

  .detect-comparison {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--color-border);
    border: 1px solid var(--color-border);
    margin-bottom: var(--spacing-lg);
  }

  .compare-col {
    background: var(--color-bg);
    padding: var(--spacing-md);
  }

  .compare-label {
    font-size: 0.5625rem;
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--spacing-xs);
  }

  .compare-text {
    font-size: 0.8125rem;
    line-height: 1.5;
    word-break: break-word;
    min-height: 2rem;
  }

  .compare-stat {
    font-size: 0.625rem;
    color: var(--color-text-tertiary);
    margin-top: var(--spacing-xs);
  }

  .char-breakdown {
    border: 1px solid var(--color-border);
    padding: var(--spacing-md);
  }

  .breakdown-label {
    font-size: 0.5625rem;
    color: var(--color-text-tertiary);
    text-transform: uppercase;
    letter-spacing: 0.1em;
    margin-bottom: var(--spacing-md);
  }

  :global(.breakdown-bar-row) {
    display: grid;
    grid-template-columns: 100px 1fr 60px;
    gap: var(--spacing-md);
    align-items: center;
    margin-bottom: var(--spacing-sm);
    font-size: 0.6875rem;
  }

  :global(.breakdown-bar-label) { color: var(--color-text-secondary); }

  :global(.breakdown-bar-track) {
    height: 6px;
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    position: relative;
    overflow: hidden;
  }

  :global(.breakdown-bar-fill) {
    position: absolute;
    top: 0; left: 0; bottom: 0;
    background: var(--color-text);
    transition: width 0.4s ease;
  }

  :global(.breakdown-bar-fill.zw) { background: var(--color-text-secondary); }

  :global(.breakdown-bar-count) { color: var(--color-text-tertiary); text-align: right; }

  .examples-hint {
    font-size: 0.75rem;
    color: var(--color-text-secondary);
    margin-bottom: var(--spacing-md);
  }

  .example-btn {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 4px;
    width: 100%;
    text-align: left;
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-sm);
    border: 1px solid var(--color-border);
    background: transparent;
    font-family: var(--font-mono);
  }

  .example-btn:hover { border-color: var(--color-border-light); }

  .ex-label {
    font-size: 0.8125rem;
    color: var(--color-text);
  }

  .ex-desc {
    font-size: 0.6875rem;
    color: var(--color-text-tertiary);
    text-align: left;
  }

  .examples-note {
    font-size: 0.6875rem;
    color: var(--color-text-tertiary);
    padding: var(--spacing-sm);
    border: 1px solid var(--color-border);
    border-style: dashed;
  }

  @media (max-width: 768px) {
    .detect-grid { grid-template-columns: 1fr; }
    .detect-comparison { grid-template-columns: 1fr; }
  }
</style>
